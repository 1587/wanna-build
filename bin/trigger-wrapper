#!/bin/bash

[ -n "$SSH_ORIGINAL_COMMAND" ] || exit 1

trigger_name=$(basename "$1")

set -- $SSH_ORIGINAL_COMMAND

shift
args="$*"

echo "$(date): $trigger_name | $args" >> /org/wanna-build/db/signal.log

if [ ! -z "$args" ]
then
    # Append because we might get triggered for multiple suites.
    # (This is mainly for security currently.)
    echo $args >> /org/wanna-build/signals/$trigger_name
else
    touch /org/wanna-build/signals/$trigger_name
fi

exit 0

